@page
@model Abby.Pages.Categories.IndexModel

<div class="container p-3">
    <h2 class="text-primary">Categories</h2>
    <table class="table table-striped table-bordered mt-3">
        <thead>
            <tr>
                <th>Category Name</th>
                <th>Display Order</th>
            </tr>
        </thead>
        <tbody data-bind="foreach: categories">
            <tr>
                <td data-bind="text: name"></td>
                <td data-bind="text: displayOrders"></td>
            </tr>
        </tbody>
    </table>
</div>

<script>
    function Category(data) {
        this.name = ko.observable(data.name);
        this.displayOrders = ko.observable(data.displayOrders);
    }

    function ViewModel() {
        var self = this;
        self.categories = ko.observableArray([]);

        self.loadCategories = function() {
            $.getJSON('@Url.Page("/Categories/Index", "GetCategories")', function(data) {
                var mappedCategories = $.map(data, function(item) { return new Category(item); });
                self.categories(mappedCategories);
            });
        };

        self.loadCategories();
    }

    ko.applyBindings(new ViewModel());
</script>